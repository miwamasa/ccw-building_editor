# 建物データエディタ テストケース

## 概要

このドキュメントは、建物データエディタの機能を検証するためのテストケースを定義します。

## テスト環境

- **ブラウザ**: Chrome, Firefox, Safari, Edge の最新版
- **画面解像度**: 1920x1080 (推奨), 1366x768 (最小)
- **ファイル**: `building_editor.html` または `building_data_editor.html`

## テストケース一覧

### 1. 基本機能テスト

#### TC-001: 初期表示
**目的**: エディタが正しく起動し、初期状態が正しく表示されることを確認

**手順**:
1. ブラウザでエディタのHTMLファイルを開く

**期待結果**:
- ✅ タイトル「ハイブリッド空調システム 建物データエディタ」が表示される
- ✅ 4つのアクションボタンが表示される（サンプルデータ読込、JSONエクスポート、JSONインポート、JSON表示）
- ✅ タブが7つ表示される（建物情報、階、ゾーン、部屋、全館空調、個別空調、センサー）
- ✅ 「建物情報」タブが初期選択されている
- ✅ フッターに統計が表示される（すべて0）

---

#### TC-002: サンプルデータ読込
**目的**: サンプルデータが正しく読み込まれることを確認

**手順**:
1. 「サンプルデータ読込」ボタンをクリック

**期待結果**:
- ✅ 建物情報に「東京グリーンタワー」が入力される
- ✅ 各タブにサンプルデータが入力される
- ✅ フッターの統計が更新される
  - 階: 2
  - 大ゾーン: 3
  - 小ゾーン: 7
  - 部屋: 9
  - チラー: 1
  - AHU: 2
  - VRF: 3
  - センサー: 7以上

---

#### TC-003: JSONエクスポート
**目的**: データをJSON形式で正しくエクスポートできることを確認

**前提条件**: サンプルデータが読み込まれている

**手順**:
1. 「JSONエクスポート」ボタンをクリック
2. ダウンロードされたファイルを確認

**期待結果**:
- ✅ `building_data_Building_A.json` というファイルがダウンロードされる
- ✅ ファイルを開くと、正しいJSON形式のデータが含まれている
- ✅ すべての入力データが含まれている

---

#### TC-004: JSONインポート
**目的**: エクスポートしたJSONファイルを正しく読み込めることを確認

**前提条件**: TC-003でエクスポートしたJSONファイルがある

**手順**:
1. ページをリロードして初期状態に戻す
2. 「JSONインポート」ボタンをクリック
3. エクスポートしたJSONファイルを選択
4. アラートで「データを読み込みました」と表示されることを確認

**期待結果**:
- ✅ アラートが表示される
- ✅ すべてのデータが復元される
- ✅ フッター統計がエクスポート前と同じになる

---

#### TC-005: JSON表示
**目的**: JSON構造をリアルタイムで確認できることを検証

**前提条件**: サンプルデータが読み込まれている

**手順**:
1. 「JSON表示」ボタンをクリック
2. JSON表示エリアを確認
3. もう一度「JSON表示」ボタンをクリック

**期待結果**:
- ✅ 1回目のクリックでJSON表示エリアが表示される
- ✅ JSONデータが緑色のコードブロックで表示される
- ✅ 2回目のクリックでJSON表示エリアが非表示になる

---

### 2. データ入力テスト

#### TC-101: 建物情報の入力
**目的**: 建物基本情報を正しく入力できることを確認

**手順**:
1. 「建物情報」タブを開く
2. 以下を入力:
   - 建物ID: `Building_Test`
   - 建物名: `テストビル`
   - 所在地: `大阪府大阪市`
   - 延床面積: `5000`
3. 「JSON表示」で内容を確認

**期待結果**:
- ✅ すべてのフィールドが入力できる
- ✅ JSON表示で正しい値が反映されている
- ✅ 数値フィールド（延床面積）が数値型で保存されている

---

#### TC-102: 階の追加
**目的**: 階を追加できることを確認

**手順**:
1. 「階」タブを開く
2. 「階を追加」ボタンを3回クリック
3. 各階に以下を入力:
   - 1階: ID=`Floor_1`, 名称=`1階`, 面積=`2000`
   - 2階: ID=`Floor_2`, 名称=`2階`, 面積=`1500`
   - 3階: ID=`Floor_3`, 名称=`3階`, 面積=`1500`

**期待結果**:
- ✅ 階が3つ追加される
- ✅ 各フィールドに入力できる
- ✅ フッター統計の「階」が3になる

---

#### TC-103: 階の削除
**目的**: 階を削除できることを確認

**前提条件**: TC-102で3階分のデータがある

**手順**:
1. 「階」タブで3階のゴミ箱アイコンをクリック

**期待結果**:
- ✅ 3階のデータが削除される
- ✅ フッター統計の「階」が2になる
- ✅ 1階と2階のデータは残っている

---

#### TC-104: 大ゾーンの追加と関連付け
**目的**: 大ゾーンを追加し、階とAHUを関連付けられることを確認

**前提条件**: 階とAHUのデータがある

**手順**:
1. 「ゾーン」タブを開く
2. 「大ゾーン追加」ボタンをクリック
3. 以下を入力:
   - ID: `LargeZone_1A`
   - 名称: `大ゾーン1A`
   - 階: ドロップダウンから`Floor_1`を選択
   - AHU: ドロップダウンから`AHU_1`を選択

**期待結果**:
- ✅ 大ゾーンが追加される
- ✅ ドロップダウンに階とAHUの選択肢が表示される
- ✅ 選択した値がJSONに反映される

---

#### TC-105: 小ゾーンの追加と関連付け
**目的**: 小ゾーンを追加し、大ゾーンとVRFを関連付けられることを確認

**前提条件**: 大ゾーンとVRFのデータがある

**手順**:
1. 「ゾーン」タブを開く
2. 「小ゾーン追加」ボタンをクリック
3. 以下を入力:
   - ID: `SmallZone_1A1`
   - 名称: `小ゾーン1A1`
   - 大ゾーン: `LargeZone_1A`を選択
   - VRF: `VRF_Unit_1`を選択

**期待結果**:
- ✅ 小ゾーンが追加される
- ✅ ドロップダウンに大ゾーンとVRFの選択肢が表示される
- ✅ 選択した値がJSONに反映される

---

#### TC-106: 部屋の追加
**目的**: 部屋を追加し、小ゾーンに関連付けられることを確認

**前提条件**: 小ゾーンのデータがある

**手順**:
1. 「部屋」タブを開く
2. 「部屋を追加」ボタンをクリック
3. 以下を入力:
   - ID: `Room_101`
   - 名称: `会議室101`
   - 小ゾーン: `SmallZone_1A1`を選択
   - 面積: `30`

**期待結果**:
- ✅ 部屋が追加される
- ✅ 小ゾーンのドロップダウンが機能する
- ✅ 面積が数値として保存される

---

#### TC-107: チラーの追加
**目的**: チラーを追加できることを確認

**手順**:
1. 「全館空調」タブを開く
2. 「チラー追加」ボタンをクリック
3. 以下を入力:
   - ID: `Chiller_1`
   - 名称: `チラー1号機`
   - 容量: `150`
   - 定格電力: `50`

**期待結果**:
- ✅ チラーが追加される
- ✅ 数値フィールドが正しく機能する
- ✅ フッター統計の「チラー」が1になる

---

#### TC-108: AHUの追加と関連付け
**目的**: AHUを追加し、チラーに関連付けられることを確認

**前提条件**: チラーのデータがある

**手順**:
1. 「全館空調」タブを開く
2. 「AHU追加」ボタンをクリック
3. 以下を入力:
   - ID: `AHU_1`
   - 名称: `外調機1号機`
   - チラー: `Chiller_1`を選択
   - 風量: `10000`

**期待結果**:
- ✅ AHUが追加される
- ✅ チラーのドロップダウンが機能する
- ✅ 風量が数値として保存される

---

#### TC-109: VAVの追加と関連付け
**目的**: VAVを追加し、AHUと大ゾーンに関連付けられることを確認

**前提条件**: AHUと大ゾーンのデータがある

**手順**:
1. 「全館空調」タブを開く
2. 「VAV追加」ボタンをクリック
3. 以下を入力:
   - ID: `VAV_1A1`
   - 名称: `VAV 1A-1`
   - AHU: `AHU_1`を選択
   - 大ゾーン: `LargeZone_1A`を選択

**期待結果**:
- ✅ VAVが追加される
- ✅ 両方のドロップダウンが機能する

---

#### TC-110: VRFの追加
**目的**: VRF室外機を追加できることを確認

**手順**:
1. 「個別空調」タブを開く
2. 「VRF追加」ボタンをクリック
3. 以下を入力:
   - ID: `VRF_Unit_1`
   - 名称: `VRF室外機1号機`
   - 容量: `40`
   - 定格電力: `15`

**期待結果**:
- ✅ VRFが追加される
- ✅ フッター統計の「VRF」が1になる

---

#### TC-111: センサーの追加
**目的**: センサーを追加できることを確認

**手順**:
1. 「センサー」タブを開く
2. 「センサー追加」ボタンをクリック
3. 以下を入力:
   - ID: `AHU1_Outside_Air_Temp`
   - 名称: `外調機1_外気温度センサー`
   - 種類: `temperature`を選択
   - 設備ID: `AHU_1`
   - 単位: `°C`

**期待結果**:
- ✅ センサーが追加される
- ✅ 種類のドロップダウンで選択できる
- ✅ フッター統計の「センサー」が1になる

---

### 3. データ整合性テスト

#### TC-201: 横断構成のテスト
**目的**: VRFが複数の大ゾーンをまたぐ構成を正しく表現できることを確認

**手順**:
1. サンプルデータを読み込む
2. 小ゾーンのデータを確認:
   - `SmallZone_1A1` (大ゾーン1A) → VRF_Unit_1
   - `SmallZone_1A2` (大ゾーン1A) → VRF_Unit_1
   - `SmallZone_1B1` (大ゾーン1B) → VRF_Unit_1

**期待結果**:
- ✅ 同じVRF_Unit_1が異なる大ゾーンの小ゾーンに割り当てられている
- ✅ JSONで横断構成が正しく表現されている

---

#### TC-202: IDの一意性チェック
**目的**: 同じIDが重複しないことを確認（手動チェック）

**手順**:
1. サンプルデータを読み込む
2. JSON表示で各要素のIDを確認

**期待結果**:
- ✅ 同じ種類の要素内でIDが重複していない
- ✅ 異なる種類の要素間ではIDが重複してもよい（例: Floor_1とVRF_Unit_1）

---

#### TC-203: 参照整合性チェック
**目的**: 参照先のIDが存在することを確認

**手順**:
1. サンプルデータを読み込む
2. 各要素の参照を確認:
   - 大ゾーンのfloorIdが存在する階を参照しているか
   - 大ゾーンのahuIdが存在するAHUを参照しているか
   - 小ゾーンのlargeZoneIdが存在する大ゾーンを参照しているか
   - 小ゾーンのvrfIdが存在するVRFを参照しているか

**期待結果**:
- ✅ すべての参照が有効である（参照先が存在する）

---

### 4. エラーハンドリングテスト

#### TC-301: 不正なJSON読込
**目的**: 不正なJSONファイルを読み込んだときの動作を確認

**手順**:
1. テキストエディタで不正なJSON（構文エラーあり）を作成
2. 「JSONインポート」で読み込む

**期待結果**:
- ✅ エラーアラートが表示される
- ✅ 既存のデータは保持される（破壊されない）

---

#### TC-302: 空のデータでエクスポート
**目的**: データが入力されていない状態でエクスポートできることを確認

**手順**:
1. ページをリロードして初期状態にする
2. 「JSONエクスポート」ボタンをクリック

**期待結果**:
- ✅ JSONファイルがダウンロードされる
- ✅ 空の配列とデフォルト値が含まれている

---

### 5. UI/UXテスト

#### TC-401: タブ切り替え
**目的**: すべてのタブが正しく切り替わることを確認

**手順**:
1. 各タブを順番にクリック

**期待結果**:
- ✅ すべてのタブが正しく表示される
- ✅ アクティブなタブが青色でハイライトされる
- ✅ タブを切り替えても入力データは保持される

---

#### TC-402: レスポンシブデザイン
**目的**: 異なる画面サイズで正しく表示されることを確認

**手順**:
1. ブラウザのウィンドウサイズを変更
   - デスクトップ (1920x1080)
   - タブレット (1024x768)
   - モバイル (375x667)

**期待結果**:
- ✅ すべての画面サイズで要素が見切れない
- ✅ ボタンやフィールドが操作可能
- ✅ タブが横スクロール可能（小画面時）

---

#### TC-403: フッター統計の更新
**目的**: データの追加・削除に応じて統計が更新されることを確認

**手順**:
1. 階を追加 → フッター確認
2. 大ゾーンを追加 → フッター確認
3. 部屋を削除 → フッター確認

**期待結果**:
- ✅ 各操作後、即座にフッター統計が更新される

---

## テスト実施記録

| テストケース | 実施日 | 結果 | 備考 |
|------------|--------|------|------|
| TC-001 | YYYY/MM/DD | ✅/❌ | |
| TC-002 | YYYY/MM/DD | ✅/❌ | |
| ... | ... | ... | ... |

## 既知の問題

1. **問題**: ページリロードでデータが消える
   - **原因**: ブラウザのメモリに保存されているため
   - **回避策**: こまめにJSONエクスポートする

2. **問題**: 大量のデータを入力すると動作が遅くなる
   - **原因**: React の再レンダリング
   - **回避策**: 適度な規模のデータに留める

## 改善提案

1. LocalStorageへの自動保存機能
2. データバリデーション機能
3. Undo/Redo機能
4. データのインポート/エクスポート時のプログレスバー
5. ドラッグ&ドロップでの並び替え機能

---

**作成日**: 2025年10月23日  
**バージョン**: 1.0
